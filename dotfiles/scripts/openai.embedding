#!/bin/bash

TOKEN=$(cat ~/.config/openai/token)
INPUT=$(cat /dev/stdin)
BODY=$(echo "{
    \"model\": \"text-embedding-ada-002\",
    \"input\": \"${INPUT//$'\n'/\\n}\"
}" | jq -rc)

curl -s https://api.openai.com/v1/embeddings \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer $TOKEN" \
  -d "$BODY" | jq -rc '.data[0].embedding'
